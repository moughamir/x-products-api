version: "3.9"

services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8080:80"
    environment:
      APP_ENV: production
      SQLITE_PATH: /var/www/html/cosmos/data/sqlite/database.sqlite
    volumes:
      # Mount the entire project to /var/www/html/cosmos (matching production)
      - ./:/var/www/html/cosmos
      - sqlite_data:/var/www/html/cosmos/data/sqlite
    depends_on:
      - sqlite

  sqlite:
    image: alpine:3.20
    command: ["/bin/sh", "-c", "mkdir -p /var/www/sqlite && tail -f /dev/null"]
    volumes:
      - sqlite_data:/var/www/sqlite

volumes:
  sqlite_data:
    driver: local
